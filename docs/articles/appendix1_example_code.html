<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Appendix 1: Example Code • lmem.sim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Appendix 1: Example Code">
<meta property="og:description" content="lmem.sim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lmem.sim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/appendix1_example_code.html">Appendix 1: Example Code</a>
    </li>
    <li>
      <a href="../articles/appendix1b_example_code.html">Appendix 1b: Example Code (no tidyverse)</a>
    </li>
    <li>
      <a href="../articles/appendix1c_sensitivity.html">Appendix 1c: Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/appendix2_extended_example.html">Appendix 2: Extended Example</a>
    </li>
    <li>
      <a href="../articles/appendix3_binomial.html">Appendix 3: Binomial Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="appendix1_example_code_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Appendix 1: Example Code</h1>
            <h3 class="subtitle">Understanding mixed effects models through data simulation</h3>
                        <h4 class="author">Lisa M. DeBruine &amp; Dale J. Barr</h4>
            
      
      
      <div class="hidden name"><code>appendix1_example_code.Rmd</code></div>

    </div>

    
    
<div id="simulating-data-with-crossed-random-factors" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-data-with-crossed-random-factors" class="anchor"></a>Simulating data with crossed random factors</h2>
<p>To give an overview of the simulation task, we will simulate data from a design with crossed random factors of subjects and stimuli, fit a model to the simulated data, and then try to recover the parameter values we put in from the output. In this hypothetical study, subjects classify the emotional expressions of faces as quickly as possible, and we use their response time as the primary dependent variable. Let’s imagine that the faces are of two intrinsic types: either from the subject’s ingroup or from an outgroup. For simplicity, we further assume that each face appears only once in the stimulus set. The key question is whether there is any difference in classification speed across the type of face.</p>
<div id="required-software" class="section level3">
<h3 class="hasAnchor">
<a href="#required-software" class="anchor"></a>Required software</h3>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># load required packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"lme4"</span>)        <span class="co"># model specification / estimation</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"afex"</span>)        <span class="co"># anova and deriving p-values from lmer</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"broom.mixed"</span>) <span class="co"># extracting data from model fits </span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"tidyverse"</span>)   <span class="co"># data wrangling and visualisation</span>

<span class="co"># ensure this script returns the same results on each run</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">8675309</span>)</pre></body></html></div>
</div>
<div id="establishing-the-data-generating-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#establishing-the-data-generating-parameters" class="anchor"></a>Establishing the data-generating parameters</h3>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># set all data-generating parameters</span>
<span class="no">b0</span>     <span class="kw">&lt;-</span> <span class="fl">800</span> <span class="co"># intercept; i.e., the grand mean</span>
<span class="no">b1</span>     <span class="kw">&lt;-</span>  <span class="fl">50</span> <span class="co"># slope; i.e, effect of category</span>
<span class="no">S0s_sd</span> <span class="kw">&lt;-</span> <span class="fl">100</span> <span class="co"># by-subject random intercept sd</span>
<span class="no">I0i_sd</span> <span class="kw">&lt;-</span>  <span class="fl">80</span> <span class="co"># by-item random intercept sd</span>
<span class="no">S1s_sd</span> <span class="kw">&lt;-</span>  <span class="fl">40</span> <span class="co"># by-subject random slope sd</span>
<span class="no">scor</span>   <span class="kw">&lt;-</span>  <span class="fl">.2</span> <span class="co"># correlation between intercept and slope</span>
<span class="no">err_sd</span> <span class="kw">&lt;-</span> <span class="fl">200</span> <span class="co"># residual (error) sd</span></pre></body></html></div>
</div>
<div id="simulating-the-sampling-process" class="section level3">
<h3 class="hasAnchor">
<a href="#simulating-the-sampling-process" class="anchor"></a>Simulating the sampling process</h3>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># set number of subjects and items</span>
<span class="no">nsubj</span>  <span class="kw">&lt;-</span> <span class="fl">100</span> <span class="co"># number of subjects</span>
<span class="no">nitem</span>  <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">ingroup</span> <span class="kw">=</span> <span class="fl">25</span>, <span class="kw">outgroup</span> <span class="kw">=</span> <span class="fl">25</span>)  <span class="co"># number of items</span></pre></body></html></div>
<div id="simulate-the-sampling-of-stimulus-items" class="section level4">
<h4 class="hasAnchor">
<a href="#simulate-the-sampling-of-stimulus-items" class="anchor"></a>Simulate the sampling of stimulus items</h4>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># simulate a sample of items</span>
<span class="no">items</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">item_id</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">nitem</span>),
  <span class="kw">category</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ingroup"</span>, <span class="st">"outgroup"</span>), <span class="no">nitem</span>),
  <span class="kw">I0i</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">nitem</span>), <span class="fl">0</span>, <span class="no">I0i_sd</span>)
)</pre></body></html></div>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># effect-code category</span>
<span class="no">items</span>$<span class="no">cat</span> <span class="kw">&lt;-</span> <span class="fu">recode</span>(<span class="no">items</span>$<span class="no">category</span>, <span class="st">"ingroup"</span> <span class="kw">=</span> -<span class="fl">0.5</span>, <span class="st">"outgroup"</span> <span class="kw">=</span> +<span class="fl">0.5</span>)</pre></body></html></div>
</div>
<div id="simulate-the-sampling-of-subjects" class="section level4">
<h4 class="hasAnchor">
<a href="#simulate-the-sampling-of-subjects" class="anchor"></a>Simulate the sampling of subjects</h4>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># simulate a sample of subjects</span>

<span class="co"># make the correlation matrix</span>
<span class="no">cormat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(   <span class="fl">1</span>, <span class="no">scor</span>,
                   <span class="no">scor</span>,    <span class="fl">1</span>),
             <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># make a corresponding matrix of the variance </span>
<span class="co"># (multiply the SDs for each cell)</span>
<span class="no">varmat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">S0s_sd</span> * <span class="no">S0s_sd</span>, <span class="no">S0s_sd</span> * <span class="no">S1s_sd</span>,
                  <span class="no">S0s_sd</span> * <span class="no">S1s_sd</span>, <span class="no">S1s_sd</span> * <span class="no">S1s_sd</span>),
             <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># create correlated variables with the specified parameters</span>
<span class="no">S</span> <span class="kw">&lt;-</span> <span class="kw pkg">MASS</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="no">nsubj</span>, <span class="kw">mu</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>), <span class="kw">Sigma</span> <span class="kw">=</span> <span class="no">cormat</span> * <span class="no">varmat</span>)

<span class="no">subjects</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">subj_id</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="no">nsubj</span>,
  <span class="kw">S0s</span> <span class="kw">=</span> <span class="no">S</span>[, <span class="fl">1</span>],
  <span class="kw">S1s</span> <span class="kw">=</span> <span class="no">S</span>[, <span class="fl">2</span>]
)</pre></body></html></div>
</div>
<div id="simulate-trials-encounters" class="section level4">
<h4 class="hasAnchor">
<a href="#simulate-trials-encounters" class="anchor"></a>Simulate trials (encounters)</h4>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># cross subject and item IDs; add an error term</span>
<span class="no">trials</span> <span class="kw">&lt;-</span> <span class="fu">crossing</span>(<span class="kw">subj_id</span> <span class="kw">=</span> <span class="no">subjects</span>$<span class="no">subj_id</span>,
                   <span class="kw">item_id</span> <span class="kw">=</span> <span class="no">items</span>$<span class="no">item_id</span>)  <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">err</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">.</span>), <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="no">err_sd</span>))

<span class="co"># join subject and item tables</span>
<span class="no">joined</span> <span class="kw">&lt;-</span> <span class="no">trials</span> <span class="kw">%&gt;%</span>
  <span class="fu">inner_join</span>(<span class="no">subjects</span>, <span class="st">"subj_id"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">inner_join</span>(<span class="no">items</span>, <span class="st">"item_id"</span>)</pre></body></html></div>
</div>
<div id="calculate-the-response-values" class="section level4">
<h4 class="hasAnchor">
<a href="#calculate-the-response-values" class="anchor"></a>Calculate the response values</h4>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># calculate the response variable</span>
<span class="no">dat_sim</span> <span class="kw">&lt;-</span> <span class="no">joined</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">RT</span> <span class="kw">=</span> <span class="no">b0</span> + <span class="no">I0i</span> + <span class="no">S0s</span> + (<span class="no">b1</span> + <span class="no">S1s</span>) * <span class="no">cat</span> + <span class="no">err</span>) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">subj_id</span>, <span class="no">item_id</span>, <span class="no">category</span>, <span class="no">cat</span>, <span class="no">RT</span>)</pre></body></html></div>
</div>
</div>
<div id="data-simulation-function" class="section level3">
<h3 class="hasAnchor">
<a href="#data-simulation-function" class="anchor"></a>Data simulation function</h3>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># set up the custom data simulation function</span>
<span class="no">my_sim_data</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">nsubj</span>  <span class="kw">=</span> <span class="fl">100</span>, <span class="co"># number of subjects</span>
                        <span class="no">nitem</span>  <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">ingroup</span> <span class="kw">=</span> <span class="fl">25</span>, <span class="kw">outgroup</span> <span class="kw">=</span> <span class="fl">25</span>),  <span class="co"># number of items</span>
                        <span class="no">b0</span>     <span class="kw">=</span> <span class="fl">800</span>, <span class="co"># grand mean</span>
                        <span class="no">b1</span>     <span class="kw">=</span>  <span class="fl">50</span>, <span class="co"># effect of category</span>
                        <span class="no">I0i_sd</span> <span class="kw">=</span>  <span class="fl">80</span>, <span class="co"># by-item random intercept sd</span>
                        <span class="no">S0s_sd</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="co"># by-subject random intercept sd</span>
                        <span class="no">S1s_sd</span> <span class="kw">=</span>  <span class="fl">40</span>, <span class="co"># by-subject random slope sd</span>
                        <span class="no">scor</span>   <span class="kw">=</span> <span class="fl">0.2</span>, <span class="co"># correlation between intercept and slope</span>
                        <span class="no">err_sd</span> <span class="kw">=</span> <span class="fl">200</span>  <span class="co"># residual (standard deviation)</span>
                        ) {
  <span class="co"># simulate items</span>
  <span class="no">items</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">item_id</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">nitem</span>),
    <span class="kw">category</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ingroup"</span>, <span class="st">"outgroup"</span>), <span class="no">nitem</span>),
    <span class="kw">I0i</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">nitem</span>), <span class="fl">0</span>, <span class="no">I0i_sd</span>)
  )

  <span class="co"># effect code category</span>
  <span class="no">items</span>$<span class="no">cat</span> <span class="kw">&lt;-</span> <span class="fu">recode</span>(<span class="no">items</span>$<span class="no">category</span>, <span class="st">"ingroup"</span> <span class="kw">=</span> -<span class="fl">0.5</span>, <span class="st">"outgroup"</span> <span class="kw">=</span> <span class="fl">0.5</span>)

  <span class="co"># simulate subjects</span>
  <span class="co"># make the correlation matrix</span>
  <span class="no">cormat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(   <span class="fl">1</span>, <span class="no">scor</span>,
                     <span class="no">scor</span>,    <span class="fl">1</span>),
               <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

  <span class="co"># make a corresponding matrix of the variance </span>
  <span class="co"># (multiply the SDs for each cell)</span>
  <span class="no">varmat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">S0s_sd</span> * <span class="no">S0s_sd</span>, <span class="no">S0s_sd</span> * <span class="no">S1s_sd</span>,
                    <span class="no">S0s_sd</span> * <span class="no">S1s_sd</span>, <span class="no">S1s_sd</span> * <span class="no">S1s_sd</span>),
               <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

  <span class="co"># create correlated variables with the specified parameters</span>
  <span class="no">S</span> <span class="kw">&lt;-</span> <span class="kw pkg">MASS</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="no">nsubj</span>, <span class="kw">mu</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>), <span class="kw">Sigma</span> <span class="kw">=</span> <span class="no">cormat</span> * <span class="no">varmat</span>)

  <span class="no">subjects</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">subj_id</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="no">nsubj</span>,
    <span class="kw">S0s</span> <span class="kw">=</span> <span class="no">S</span>[, <span class="fl">1</span>],
    <span class="kw">S1s</span> <span class="kw">=</span> <span class="no">S</span>[, <span class="fl">2</span>]
  )

  <span class="co"># simulate trials</span>
  <span class="no">dat_sim</span> <span class="kw">&lt;-</span> <span class="fu">crossing</span>(<span class="kw">subj_id</span> <span class="kw">=</span> <span class="no">subjects</span>$<span class="no">subj_id</span>,
                      <span class="kw">item_id</span> <span class="kw">=</span> <span class="no">items</span>$<span class="no">item_id</span>) <span class="kw">%&gt;%</span>
    <span class="fu">inner_join</span>(<span class="no">subjects</span>, <span class="st">"subj_id"</span>) <span class="kw">%&gt;%</span>
    <span class="fu">inner_join</span>(<span class="no">items</span>, <span class="st">"item_id"</span>) <span class="kw">%&gt;%</span>
    <span class="fu">mutate</span>(<span class="kw">err</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">.</span>), <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="no">err_sd</span>)) <span class="kw">%&gt;%</span>
    <span class="fu">mutate</span>(<span class="kw">RT</span> <span class="kw">=</span> <span class="no">b0</span> + <span class="no">I0i</span> + <span class="no">S0s</span> + (<span class="no">b1</span> + <span class="no">S1s</span>) * <span class="no">cat</span> + <span class="no">err</span>) <span class="kw">%&gt;%</span>
    <span class="fu">select</span>(<span class="no">subj_id</span>, <span class="no">item_id</span>, <span class="no">category</span>, <span class="no">cat</span>, <span class="no">RT</span>)

  <span class="no">dat_sim</span>
}</pre></body></html></div>
</div>
</div>
<div id="analyzing-the-simulated-data" class="section level2">
<h2 class="hasAnchor">
<a href="#analyzing-the-simulated-data" class="anchor"></a>Analyzing the simulated data</h2>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># fit a linear mixed-effects model to data</span>
<span class="no">mod_sim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span>(<span class="no">RT</span> ~ <span class="fl">1</span> + <span class="no">cat</span> + (<span class="fl">1</span> <span class="kw">|</span> <span class="no">item_id</span>) + (<span class="fl">1</span> + <span class="no">cat</span> <span class="kw">|</span> <span class="no">subj_id</span>),
                <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat_sim</span>, <span class="kw">REML</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_sim</span>, <span class="kw">corr</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: RT ~ 1 + cat + (1 | item_id) + (1 + cat | subj_id)
##    Data: dat_sim
## 
## REML criterion at convergence: 67740.7
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.7370 -0.6732  0.0075  0.6708  3.5524 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr
##  subj_id  (Intercept)  8416     91.74       
##           cat          3298     57.43   0.12
##  item_id  (Intercept)  4072     63.81       
##  Residual             41283    203.18       
## Number of obs: 5000, groups:  subj_id, 100; item_id, 50
## 
## Fixed effects:
##             Estimate Std. Error     df t value Pr(&gt;|t|)    
## (Intercept)   807.72      13.19 119.05  61.258   &lt;2e-16 ***
## cat            39.47      19.79  56.30   1.994    0.051 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co"># get a tidy table of results</span>
<span class="kw pkg">broom.mixed</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/broom.mixed/man/reexports.html">tidy</a></span>(<span class="no">mod_sim</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">sim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">b0</span>, <span class="no">b1</span>, <span class="no">S0s_sd</span>, <span class="no">S1s_sd</span>, <span class="no">scor</span>, <span class="no">I0i_sd</span>, <span class="no">err_sd</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="fl">1</span>:<span class="fl">3</span>, <span class="fl">9</span>, <span class="fl">4</span>:<span class="fl">8</span>)</pre></body></html></div>
<pre><code>## # A tibble: 7 x 9
##   effect  group   term          sim estimate std.error statistic    df   p.value
##   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
## 1 fixed   &lt;NA&gt;    (Intercept) 800    808.         13.2     61.3  119.   7.22e-92
## 2 fixed   &lt;NA&gt;    cat          50     39.5        19.8      1.99  56.3  5.10e- 2
## 3 ran_pa… subj_id sd__(Inter… 100     91.7        NA       NA     NA   NA       
## 4 ran_pa… subj_id cor__(Inte…  40      0.121      NA       NA     NA   NA       
## 5 ran_pa… subj_id sd__cat       0.2   57.4        NA       NA     NA   NA       
## 6 ran_pa… item_id sd__(Inter…  80     63.8        NA       NA     NA   NA       
## 7 ran_pa… Residu… sd__Observ… 200    203.         NA       NA     NA   NA</code></pre>
</div>
<div id="calculate-power" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-power" class="anchor"></a>Calculate Power</h2>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># set up the power function</span>
<span class="no">my_lmer_power</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">...</span>) {
  <span class="co"># ... is a shortcut that forwards any arguments to my_sim_data()</span>
  <span class="no">dat_sim</span> <span class="kw">&lt;-</span> <span class="fu">my_sim_data</span>(<span class="no">...</span>)
  <span class="no">mod_sim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span>(<span class="no">RT</span> ~ <span class="no">cat</span> + (<span class="fl">1</span> <span class="kw">|</span> <span class="no">item_id</span>) + (<span class="fl">1</span> + <span class="no">cat</span> <span class="kw">|</span> <span class="no">subj_id</span>),
                <span class="no">dat_sim</span>, <span class="kw">REML</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

  <span class="kw pkg">broom.mixed</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/broom.mixed/man/reexports.html">tidy</a></span>(<span class="no">mod_sim</span>)
}</pre></body></html></div>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="co"># run one model with default parameters</span>
<span class="fu">my_lmer_power</span>()</pre></body></html></div>
<pre><code>## # A tibble: 7 x 8
##   effect   group   term             estimate std.error statistic    df   p.value
##   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
## 1 fixed    &lt;NA&gt;    (Intercept)       813.         14.3     56.9  115.   2.93e-86
## 2 fixed    &lt;NA&gt;    cat                83.4        21.8      3.82  53.3  3.53e- 4
## 3 ran_pars subj_id sd__(Intercept)    94.5        NA       NA     NA   NA       
## 4 ran_pars subj_id cor__(Intercept…    0.188      NA       NA     NA   NA       
## 5 ran_pars subj_id sd__cat            41.4        NA       NA     NA   NA       
## 6 ran_pars item_id sd__(Intercept)    73.2        NA       NA     NA   NA       
## 7 ran_pars Residu… sd__Observation   199.         NA       NA     NA   NA</code></pre>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="co"># run one model with new parameters</span>
<span class="fu">my_lmer_power</span>(<span class="kw">nitem</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">ingroup</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">outgroup</span> <span class="kw">=</span> <span class="fl">50</span>), <span class="kw">b1</span> <span class="kw">=</span> <span class="fl">20</span>)</pre></body></html></div>
<pre><code>## # A tibble: 7 x 8
##   effect   group   term            estimate std.error statistic    df    p.value
##   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 fixed    &lt;NA&gt;    (Intercept)      793.         13.6     58.2   170.  4.56e-114
## 2 fixed    &lt;NA&gt;    cat               22.2        16.0      1.39  107.  1.68e-  1
## 3 ran_pars item_id sd__(Intercept)   75.7        NA       NA      NA  NA        
## 4 ran_pars subj_id sd__(Intercept)  112.         NA       NA      NA  NA        
## 5 ran_pars subj_id cor__(Intercep…    0.281      NA       NA      NA  NA        
## 6 ran_pars subj_id sd__cat           31.6        NA       NA      NA  NA        
## 7 ran_pars Residu… sd__Observation  200.         NA       NA      NA  NA</code></pre>
<p>To get an accurate estimation of power, you need to run the simulation many times. We use 100 here as an example, but your results are more accurate the more replications you run. This will depend on the specifics of your analysis, but we recommend at least 1000 replications.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># run simulations and save to a file</span>
<span class="no">reps</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">sims</span> <span class="kw">&lt;-</span> <span class="kw pkg">purrr</span><span class="kw ns">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span>(<span class="fl">1</span>:<span class="no">reps</span>, ~<span class="fu">my_lmer_power</span>())
<span class="fu">write_csv</span>(<span class="no">sims</span>, <span class="st">"sims/sims.csv"</span>)</pre></body></html></div>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="co"># read saved simulation data</span>
<span class="no">sims</span> <span class="kw">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"sims/sims.csv"</span>)</pre></body></html></div>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="co"># calculate mean estimates and power for specified alpha</span>
<span class="no">alpha</span> <span class="kw">&lt;-</span> <span class="fl">0.05</span>

<span class="no">sims</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">effect</span> <span class="kw">==</span> <span class="st">"fixed"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="no">term</span>) <span class="kw">%&gt;%</span>
  <span class="fu">summarise</span>(
    <span class="kw">mean_estimate</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">estimate</span>),
    <span class="kw">mean_se</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">std.error</span>),
    <span class="kw">power</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">p.value</span> <span class="kw">&lt;</span> <span class="no">alpha</span>),
    <span class="kw">.groups</span> <span class="kw">=</span> <span class="st">"drop"</span>
  )</pre></body></html></div>
<pre><code>## # A tibble: 2 x 4
##   term        mean_estimate mean_se power
##   &lt;chr&gt;               &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 (Intercept)         804.     15.4  1   
## 2 cat                  47.6    23.6  0.53</code></pre>
</div>
<div id="comparison-to-anova" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-to-anova" class="anchor"></a>Comparison to ANOVA</h1>
<p>One way many researchers would normally analyse data like this is by averaging each subject’s reaction times across the ingroup and outgroup stimuli and compare them using a paired-samples t-test or ANOVA (which is formally equivalent). Here, we use <code><a href="https://rdrr.io/pkg/afex/man/aov_car.html">afex::aov_ez</a></code> to analyse a version of our dataset that is aggregated by subject.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="co"># aggregate by subject and analyze with ANOVA</span>
<span class="no">dat_subj</span> <span class="kw">&lt;-</span> <span class="no">dat_sim</span> <span class="kw">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="no">subj_id</span>, <span class="no">category</span>, <span class="no">cat</span>) <span class="kw">%&gt;%</span>
  <span class="fu">summarise</span>(<span class="kw">RT</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">RT</span>), <span class="kw">.groups</span> <span class="kw">=</span> <span class="st">"drop"</span>)

<span class="kw pkg">afex</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span>(
  <span class="kw">id</span> <span class="kw">=</span> <span class="st">"subj_id"</span>,
  <span class="kw">dv</span> <span class="kw">=</span> <span class="st">"RT"</span>,
  <span class="kw">within</span> <span class="kw">=</span> <span class="st">"category"</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat_subj</span>
)</pre></body></html></div>
<pre><code>## Anova Table (Type 3 tests)
## 
## Response: RT
##     Effect    df     MSE         F  ges p.value
## 1 category 1, 99 3300.45 23.60 *** .035   &lt;.001
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</code></pre>
<p>Alternatively, you could aggregate by item, averaging all subjects’ scores for each item.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="co"># aggregate by item and analyze with ANOVA</span>
<span class="no">dat_item</span> <span class="kw">&lt;-</span>  <span class="no">dat_sim</span> <span class="kw">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="no">item_id</span>, <span class="no">category</span>, <span class="no">cat</span>) <span class="kw">%&gt;%</span>
  <span class="fu">summarise</span>(<span class="kw">RT</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">RT</span>), <span class="kw">.groups</span> <span class="kw">=</span> <span class="st">"drop"</span>)

<span class="kw pkg">afex</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span>(
  <span class="kw">id</span> <span class="kw">=</span> <span class="st">"item_id"</span>,
  <span class="kw">dv</span> <span class="kw">=</span> <span class="st">"RT"</span>,
  <span class="kw">between</span> <span class="kw">=</span> <span class="st">"category"</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat_item</span>
)</pre></body></html></div>
<pre><code>## Converting to factor: category</code></pre>
<pre><code>## Contrasts set to contr.sum for the following variables: category</code></pre>
<pre><code>## Anova Table (Type 3 tests)
## 
## Response: RT
##     Effect    df     MSE      F  ges p.value
## 1 category 1, 48 4484.87 4.34 * .083    .043
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</code></pre>
<p>We can create a power analysis function that simulates data using our data-generating process from <code>my_sim_data()</code>, creates these two aggregated datasets, and analyses them with ANOVA. We’ll just return the p-values for the effect of category as we can calculate power as the percentage of these simulations that reject the null hypothesis.</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="co"># power function for ANOVA</span>
<span class="no">my_anova_power</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">...</span>) {
  <span class="no">dat_sim</span> <span class="kw">&lt;-</span> <span class="fu">my_sim_data</span>(<span class="no">...</span>)

  <span class="no">dat_subj</span> <span class="kw">&lt;-</span>  <span class="no">dat_sim</span> <span class="kw">%&gt;%</span>
    <span class="fu">group_by</span>(<span class="no">subj_id</span>, <span class="no">category</span>, <span class="no">cat</span>) <span class="kw">%&gt;%</span>
    <span class="fu">summarise</span>(<span class="kw">RT</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">RT</span>), <span class="kw">.groups</span> <span class="kw">=</span> <span class="st">"drop"</span>)

  <span class="no">dat_item</span> <span class="kw">&lt;-</span>  <span class="no">dat_sim</span> <span class="kw">%&gt;%</span>
    <span class="fu">group_by</span>(<span class="no">item_id</span>, <span class="no">category</span>, <span class="no">cat</span>) <span class="kw">%&gt;%</span>
    <span class="fu">summarise</span>(<span class="kw">RT</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">RT</span>), <span class="kw">.groups</span> <span class="kw">=</span> <span class="st">"drop"</span>)

  <span class="no">a_subj</span> <span class="kw">&lt;-</span> <span class="kw pkg">afex</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"subj_id"</span>,
                         <span class="kw">dv</span> <span class="kw">=</span> <span class="st">"RT"</span>,
                         <span class="kw">within</span> <span class="kw">=</span> <span class="st">"category"</span>,
                         <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat_subj</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(
    <span class="co"># check contrasts message is annoying</span>
    <span class="no">a_item</span> <span class="kw">&lt;-</span> <span class="kw pkg">afex</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span>(
      <span class="kw">id</span> <span class="kw">=</span> <span class="st">"item_id"</span>,
      <span class="kw">dv</span> <span class="kw">=</span> <span class="st">"RT"</span>,
      <span class="kw">between</span> <span class="kw">=</span> <span class="st">"category"</span>,
      <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat_item</span>
    )
  )

  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="st">"subj"</span> <span class="kw">=</span> <span class="no">a_subj</span>$<span class="no">anova_table</span>$<span class="no">`Pr(&gt;F)`</span>,
    <span class="st">"item"</span> <span class="kw">=</span> <span class="no">a_item</span>$<span class="no">anova_table</span>$<span class="no">`Pr(&gt;F)`</span>
  )
}</pre></body></html></div>
<p>Run this function with the default parameters to determine the power each analysis has to detect an effect of category of 50 ms.</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="co"># run simulations and calculate power </span>
<span class="no">reps</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">anova_sims</span> <span class="kw">&lt;-</span> <span class="kw pkg">purrr</span><span class="kw ns">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span>(<span class="fl">1</span>:<span class="no">reps</span>, ~<span class="fu">my_anova_power</span>())

<span class="no">alpha</span> <span class="kw">&lt;-</span> <span class="fl">0.05</span>
<span class="no">power_subj</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">anova_sims</span>$<span class="no">subj</span> <span class="kw">&lt;</span> <span class="no">alpha</span>)
<span class="no">power_item</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">anova_sims</span>$<span class="no">item</span> <span class="kw">&lt;</span> <span class="no">alpha</span>)</pre></body></html></div>
<p>The by-subjects ANOVA has power of 0.95, while the by-items ANOVA has power of 0.49. This isn’t simply a consequence of within versus between design or the number of subjects versus items, but rather a consequence of the inflated false positive rate of some aggregated analyses.</p>
<p>Set the effect of category to 0 to calculate the false positive rate. This is the probability of concluding there is an effect when there is no actual effect in your population.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="co"># run simulations and calculate the false positive rate </span>
<span class="no">reps</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">anova_fp</span> <span class="kw">&lt;-</span> <span class="kw pkg">purrr</span><span class="kw ns">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span>(<span class="fl">1</span>:<span class="no">reps</span>, ~<span class="fu">my_anova_power</span>(<span class="kw">b1</span> <span class="kw">=</span> <span class="fl">0</span>))

<span class="no">false_pos_subj</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">anova_fp</span>$<span class="no">subj</span> <span class="kw">&lt;</span> <span class="no">alpha</span>)
<span class="no">false_pos_item</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">anova_fp</span>$<span class="no">item</span> <span class="kw">&lt;</span> <span class="no">alpha</span>)</pre></body></html></div>
<p>Ideally, your false positive rate will be equal to alpha, which we set here at 0.05. The by-subject aggregated analysis has a massively inflated false positive rate of 0.55, while the by-item aggregated analysis has a closer-to-nominal false positive rate of 0.11. This is not a mistake, but a consequence of averaging items and analysing a between-item factor. Indeed, this problem with false positives is one fo the most compelling reasons to analyze cross-classified data using mixed effects models.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lisa DeBruine, Dale Barr.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
